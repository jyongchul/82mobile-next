---
phase: 02-product-discovery
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - components/ui/Toast.tsx
  - components/providers/ToastProvider.tsx
  - hooks/useToast.ts
  - components/shop/ProductCard.tsx
  - app/layout.tsx
autonomous: true

must_haves:
  truths:
    - "Toast notification appears when user clicks Add to Cart"
    - "Toast shows product name and success message"
    - "Toast auto-dismisses after 3 seconds"
    - "Multiple toasts stack vertically"
  artifacts:
    - path: "components/ui/Toast.tsx"
      provides: "Toast UI component"
      exports: ["Toast"]
    - path: "components/providers/ToastProvider.tsx"
      provides: "Toast context provider"
      exports: ["ToastProvider", "useToastContext"]
    - path: "hooks/useToast.ts"
      provides: "Toast hook for triggering notifications"
      exports: ["useToast"]
  key_links:
    - from: "components/shop/ProductCard.tsx"
      to: "hooks/useToast.ts"
      via: "useToast() in handleAddToCart"
      pattern: "useToast\\(\\)"
    - from: "components/providers/ToastProvider.tsx"
      to: "components/ui/Toast.tsx"
      via: "renders Toast components"
      pattern: "<Toast"
---

<objective>
Implement toast notification system for add-to-cart feedback, providing immediate visual confirmation when users add products.

Purpose: Users need instant feedback (< 500ms) when adding to cart to confirm action succeeded without navigating away from current section.
Output: Toast system integrated with ProductCard, showing success notification on add-to-cart.
</objective>

<execution_context>
@/home/charles_lee/.claude/get-shit-done/workflows/execute-plan.md
@/home/charles_lee/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@components/shop/ProductCard.tsx
@stores/cart.ts
@app/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Toast system (provider + component + hook)</name>
  <files>components/ui/Toast.tsx, components/providers/ToastProvider.tsx, hooks/useToast.ts</files>
  <action>
Create Toast UI component (components/ui/Toast.tsx):

```typescript
'use client';

import { motion, AnimatePresence } from 'framer-motion';

interface ToastProps {
  id: string;
  message: string;
  type?: 'success' | 'error' | 'info';
  onClose: (id: string) => void;
}

export function Toast({ id, message, type = 'success', onClose }: ToastProps) {
  const bgColor = {
    success: 'bg-jade-green',
    error: 'bg-dancheong-red',
    info: 'bg-hanbok-blue'
  }[type];

  const icon = {
    success: '✓',
    error: '✕',
    info: 'ℹ'
  }[type];

  return (
    <motion.div
      initial={{ opacity: 0, y: 50, scale: 0.9 }}
      animate={{ opacity: 1, y: 0, scale: 1 }}
      exit={{ opacity: 0, y: 20, scale: 0.9 }}
      className={`${bgColor} text-white px-4 py-3 rounded-lg shadow-lg flex items-center gap-3 min-w-[280px] max-w-md`}
    >
      <span className="text-xl font-bold">{icon}</span>
      <span className="flex-1 font-medium">{message}</span>
      <button
        onClick={() => onClose(id)}
        className="text-white/80 hover:text-white transition-colors"
        aria-label="Close"
      >
        ✕
      </button>
    </motion.div>
  );
}
```

Create ToastProvider (components/providers/ToastProvider.tsx):

```typescript
'use client';

import { createContext, useContext, useState, useCallback, ReactNode } from 'react';
import { AnimatePresence } from 'framer-motion';
import { Toast } from '@/components/ui/Toast';

interface ToastItem {
  id: string;
  message: string;
  type: 'success' | 'error' | 'info';
}

interface ToastContextType {
  toast: (message: string, type?: 'success' | 'error' | 'info') => void;
}

const ToastContext = createContext<ToastContextType | null>(null);

export function ToastProvider({ children }: { children: ReactNode }) {
  const [toasts, setToasts] = useState<ToastItem[]>([]);

  const removeToast = useCallback((id: string) => {
    setToasts((prev) => prev.filter((t) => t.id !== id));
  }, []);

  const toast = useCallback((message: string, type: 'success' | 'error' | 'info' = 'success') => {
    const id = `toast-${Date.now()}-${Math.random().toString(36).slice(2)}`;
    setToasts((prev) => [...prev, { id, message, type }]);

    // Auto-dismiss after 3 seconds
    setTimeout(() => removeToast(id), 3000);
  }, [removeToast]);

  return (
    <ToastContext.Provider value={{ toast }}>
      {children}

      {/* Toast Container - Fixed bottom-right */}
      <div className="fixed bottom-4 right-4 z-50 flex flex-col gap-2">
        <AnimatePresence mode="popLayout">
          {toasts.map((t) => (
            <Toast
              key={t.id}
              id={t.id}
              message={t.message}
              type={t.type}
              onClose={removeToast}
            />
          ))}
        </AnimatePresence>
      </div>
    </ToastContext.Provider>
  );
}

export function useToastContext() {
  const context = useContext(ToastContext);
  if (!context) {
    throw new Error('useToastContext must be used within ToastProvider');
  }
  return context;
}
```

Create hook (hooks/useToast.ts):

```typescript
'use client';

import { useToastContext } from '@/components/providers/ToastProvider';

export function useToast() {
  const { toast } = useToastContext();
  return { toast };
}
```
  </action>
  <verify>TypeScript compiles: `cd /mnt/c/82Mobile/82mobile-next && npx tsc --noEmit`</verify>
  <done>Toast system created with provider, component, and hook</done>
</task>

<task type="auto">
  <name>Task 2: Integrate ToastProvider and update ProductCard</name>
  <files>app/layout.tsx, components/shop/ProductCard.tsx</files>
  <action>
Update app/layout.tsx to wrap children with ToastProvider:

1. Import ToastProvider: `import { ToastProvider } from '@/components/providers/ToastProvider';`
2. Wrap children (or body content) with ToastProvider inside the existing providers

Update ProductCard.tsx to show toast on add-to-cart:

1. Import useToast: `import { useToast } from '@/hooks/useToast';`
2. Add hook call inside component: `const { toast } = useToast();`
3. In handleAddToCart function, after addItem() call, add:
   ```typescript
   toast(`${name} added to cart!`, 'success');
   ```
4. Remove or keep the existing isAdding spinner state - the toast provides feedback now

Key changes to handleAddToCart:
```typescript
const handleAddToCart = async (e: React.MouseEvent) => {
  e.preventDefault();
  e.stopPropagation();

  addItem({
    productId: id,
    name,
    slug,
    price: parseFloat(price.replace(/,/g, '')),
    image
  }, 1);

  // Show success toast
  toast(`${name} added to cart!`, 'success');
};
```
  </action>
  <verify>
1. Run dev server: `cd /mnt/c/82Mobile/82mobile-next && npm run dev`
2. Open http://localhost:3000 and navigate to a product
3. Click "Add to Cart" and verify toast appears at bottom-right
4. Verify toast auto-dismisses after 3 seconds
5. Add multiple items quickly and verify toasts stack
  </verify>
  <done>Toast appears within 500ms when clicking Add to Cart</done>
</task>

</tasks>

<verification>
1. TypeScript compiles without errors
2. Toast appears when clicking Add to Cart on ProductCard
3. Toast shows product name + "added to cart!"
4. Toast dismisses after 3 seconds
5. Multiple toasts stack (bottom-up or top-down)
6. Toast has animation (fade in/slide up)
</verification>

<success_criteria>
- Add-to-cart feedback appears in < 500ms
- Toast is visually consistent with Korean design theme (jade-green success)
- Multiple toasts don't overlap or hide each other
- Works on mobile viewport
</success_criteria>

<output>
After completion, create `.planning/phases/02-product-discovery/02-02-SUMMARY.md`
</output>
